SELECT
    PERSON.ID,
    CASE PERSON.STATUSID
        WHEN 0 THEN 'Ativo'
        WHEN 1 THEN 'Inativo'
    END AS 'Status',
    STRFTIME('%d/%m/%Y', PERSON.CREATIONDATE) As 'Data',
    CASE PERSON.ENTITYTYPEID
        WHEN 0 THEN 'Pessoa Física'
        WHEN 1 THEN 'Pessoa Jurídica'
    END AS 'Entidade',
    CASE PERSON.ISPROVIDER
        WHEN 0 THEN 'Não'
        ELSE 'Sim'
    END AS 'Fornecedor',
    CASE PERSON.ISCUSTOMER
        WHEN 0 THEN 'Não'
        ELSE 'Sim'
    END AS 'Cliente',
    CASE PERSON.ISCARRIER
        WHEN 0 THEN 'Não'
        ELSE 'Sim'
    END AS 'Transportadora',
    PERSON.NAME AS 'Nome',
    PERSON.BUSINESSNAME AS 'Nome Fantasia',
    PERSON.DOCUMENT1 AS 'CPF/CNPJ',
    PERSON.DOCUMENT2 AS 'Insc. Estadual',
    PERSON.DOCUMENT3 AS 'Insc. Municipal',
    PERSON.ZIPCODE AS 'Cep',    
    PERSON.ADDRESS AS 'Endereço',
    PERSON.NUMBER AS 'Número',
    PERSON.COMPLEMENT AS 'Complemento',
    PERSON.DISTRICT AS 'Bairro',
    PERSON.CITY AS 'Cidade',
    PERSON.STATE AS 'Estado',
    PERSON.NOTE AS 'Observação',
    (SELECT PERSONCONTACT.NAME FROM PERSONCONTACT WHERE PERSON.DEFAULTCONTACTID = PERSONCONTACT.ID) AS 'Contato',
    (SELECT PERSONCONTACT.JOBTITLE FROM PERSONCONTACT WHERE PERSON.DEFAULTCONTACTID = PERSONCONTACT.ID) AS 'Cargo',
    (SELECT PERSONCONTACT.PHONE1 FROM PERSONCONTACT WHERE PERSON.DEFAULTCONTACTID = PERSONCONTACT.ID) AS 'Telefone 1',
    (SELECT PERSONCONTACT.PHONE2 FROM PERSONCONTACT WHERE PERSON.DEFAULTCONTACTID = PERSONCONTACT.ID) AS 'Telefone 2',
    (SELECT PERSONCONTACT.PHONE3 FROM PERSONCONTACT WHERE PERSON.DEFAULTCONTACTID = PERSONCONTACT.ID) AS 'Telefone 3',
    (SELECT PERSONCONTACT.EMAIL1 FROM PERSONCONTACT WHERE PERSON.DEFAULTCONTACTID = PERSONCONTACT.ID) AS 'E-Mail 1',
    (SELECT PERSONCONTACT.EMAIL2 FROM PERSONCONTACT WHERE PERSON.DEFAULTCONTACTID = PERSONCONTACT.ID) AS 'E-Mail 2'
FROM PERSON
LEFT JOIN PERSONCONTACT ON PERSONCONTACT.PERSONID = PERSON.ID
WHERE
    IFNULL(PERSON.ID, '') LIKE @ID AND
    IFNULL(PERSON.STATUSID, '') LIKE @STATUSID AND
    IFNULL(PERSON.ENTITYTYPEID, '') LIKE @ENTITYTYPEID AND
    IFNULL(PERSON.ISPROVIDER,'') LIKE @ISPROVIDER AND
    IFNULL(PERSON.ISCUSTOMER,'') LIKE @ISCUSTOMER AND
    IFNULL(PERSON.ISCARRIER,'') LIKE @ISCARRIER AND
    IFNULL(PERSON.NAME, '') LIKE @NAME AND
    IFNULL(PERSON.BUSINESSNAME, '') LIKE @BUSINESSNAME AND
    IFNULL(PERSON.DOCUMENT1, '') LIKE @FIRSTDOCUMENT AND
    IFNULL(PERSON.DOCUMENT2, '') LIKE @SECONDDOCUMENT AND
    IFNULL(PERSON.DOCUMENT3, '') LIKE @THIRDDOCUMENT AND
    IFNULL(PERSON.ZIPCODE, '') LIKE @ZIPCODE AND
    IFNULL(PERSON.ADDRESS, '') LIKE @ADDRESS AND
    IFNULL(PERSON.NUMBER, '') LIKE @NUMBER AND
    IFNULL(PERSON.COMPLEMENT, '') LIKE @COMPLEMENT AND
    IFNULL(PERSON.DISTRICT, '') LIKE @DISTRICT AND
    IFNULL(PERSON.CITY, '') LIKE @CITY AND
    IFNULL(PERSON.STATE, '') LIKE @STATE AND
    IFNULL(PERSON.NOTE, '') LIKE @NOTE AND
    IFNULL(PERSONCONTACT.NAME, '') LIKE @CONTACTNAME AND
    IFNULL(PERSONCONTACT.JOBTITLE, '') LIKE @CONTACTJOBTITLE AND
        (
            IFNULL(PERSONCONTACT.PHONE1, '') LIKE @CONTACTPHONE OR
            IFNULL(PERSONCONTACT.PHONE2, '') LIKE @CONTACTPHONE OR
            IFNULL(PERSONCONTACT.PHONE3, '') LIKE  @CONTACTPHONE
        ) AND
        (
            IFNULL(PERSONCONTACT.EMAIL1, '') LIKE  @CONTACTEMAIL OR
            IFNULL(PERSONCONTACT.EMAIL2, '') LIKE  @CONTACTEMAIL
        ) AND
    PERSON.CREATIONDATE BETWEEN @CREATIONDATEI AND @CREATIONDATEF
GROUP BY 
    PERSON.ID;